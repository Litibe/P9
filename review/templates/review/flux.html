{% extends '_base.html' %} {% load static %}
<!-- Page Home-->

{% block main_content %}
<style>
  body {
    background-image: url("{% static 'review/img/typewriter-801921_1920.jpg' %}");
    background-attachment: fixed;
    background-repeat: no-repeat;
    background-size: cover;
  }
</style>
<div
  class="container col-12 col-md-9 col-lg-6 m-auto p-2 shadow-lg borderTitle"
>
  <div class="row">
    <div class="jumbotron text-center">
      <h1>LITReview - Flux des demandes</h1>
    </div>
  </div>
</div>

<div class="container">
  <div class="row">
    <div class="m-3 p-5 bg-light borderLeft">
      {% for ticket in tickets %}
      <!--if critique associé au ticket-->
      {% if ticket.review %}
      <div class="border border-success p-4 m-3">
        <p>{{ticket.review.user}} a publié une critique</p>
        <p class="text-end">Date de demande : {{ticket.review.time_created}}</p>
        <h3 class="text-success">
          {{ ticket.review.headline }} - {{ticket.review.rating}}
        </h3>
        <p>{{ticket.review.body}}</p>

        <div class="border border-primary p-4 m-3">
          <p>{{ticket.user}} a demandé une critique</p>
          <a
            href="../ticket/{{ ticket.id }}"
            style="color: inherit; text-decoration: none"
          >
            <h3 class="text-primary">
              Ticket #{{ ticket.id }} : {{ ticket.title }}
            </h3></a
          >
          <p class="text-end">Date de demande : {{ticket.time_created}}</p>

          <div class="border border-primary p-4 m-3">
            {% if ticket.image.url %}
            <img src="{{ ticket.image.url }}" width="100px" />
            {% endif %}
            <p class="text-primary m-3">Description de la demande :</p>
            <p>{{ ticket.description }}</p>
          </div>
        </div>
      </div>
      <hr />
      {% else %}
      <div class="border border-primary p-4 m-3">
        <p>{{ticket.user}} a demandé une critique</p>
        <a
          href="../ticket/{{ ticket.id }}"
          style="color: inherit; text-decoration: none"
        >
          <h3 class="text-primary">
            Ticket #{{ ticket.id }} : {{ ticket.title }}
          </h3></a
        >
        <p class="text-end">Date de demande : {{ticket.time_created}}</p>

        <div class="border border-primary p-4 m-3">
          {% if ticket.image.url %}
          <img src="{{ ticket.image.url }}" width="100px" />
          {% else %}
          <p></p>
          {% endif %}
          <p class="text-primary m-3">Description de la demande :</p>
          <p>{{ ticket.description }}</p>
        </div>
        <div class="text-end">
          <button class="btn btn-warning">
            <a
              href="../create_new_review_for_ticket/{{ticket.id}}"
              style="color: inherit; text-decoration: none"
              >Créer une critique</a
            >
          </button>
        </div>
      </div>
      <hr />
      {% endif %}{% endfor %}
    </div>
  </div>
  {% endblock main_content %}
</div>
